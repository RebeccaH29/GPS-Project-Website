function checkUrlExists(){$.ajax({cache:!1,async:!0,dataType:"json",url:url,timeout:1500,success:function(e){return geocode(e),buildTable("sam_datatable",e),console.log("Loaded from database"),1},error:function(){return url="metadata_countries.json",$.ajax({cache:!1,async:!0,dataType:"json",url:url,success:function(e){geocode(e),buildTable("sam_datatable",e),console.log("Loaded from file")},error:function(){return $(".msg").html("Sorry, could not connect to the database. Please try after sometime."),0}}),0}})}function geocode(e){$.each(e,function(e,o){var a,n;for(key in o)a=key,n=o[key].sample_count,lat=o[key].lat,lng=o[key].lng;if(lat&&lng){var t=new google.maps.LatLng(lat,lng),l=new google.maps.Marker({position:t,map:map}),s=new google.maps.MarkerImage("img/gps_icon.gif",null,null,null,new google.maps.Size(20,20));l.setIcon(s);var r="<div style='width: 120px; text-align: left; color: grey;'><b>"+a+" : <span style='color:brown;'>"+n+"</span></b></div>",r="<div style='line-height:1.35;overflow:hidden;white-space:nowrap;font-weight:bold;'>";r+="<span style='color: #666;'>Location: </span><span style='color:brown;'>"+a+"</span><br>",r+="<span style='color: #666;'>Samples: </span><span style='color:brown;'>"+n+"</span><br>",r+="</div>";var c=new google.maps.InfoWindow({content:r,size:new google.maps.Size(50,50)});google.maps.event.addListener(l,"mouseover",function(){c.open(map,l)}),google.maps.event.addListener(l,"mouseout",function(){c.close(map,l)})}})}function buildTable(e,o){var a=document.getElementById(e),n="<table class='table table-striped'><th>Country</th><th>No. of Samples</th>";$.each(o,function(e,o){n+="<tr>";for(key in o)n+="<td>"+key+"</td><td>"+o[key].sample_count+"</td>";n+="</tr>"}),n+="</table>",$(a).html(n)}var map,geocoder,iconBase="https://maps.google.com/mapfiles/kml/shapes/";geocoder=new google.maps.Geocoder;var latlng=new google.maps.LatLng(9.554772,7.908414),mapOptions={zoom:2,center:latlng,scrollwheel:!1};map=new google.maps.Map(document.getElementById("map-canvas"),mapOptions);var url="/dataviewer/json/meta/gmd_country",total_entries=0;google.maps.event.addDomListener(window,"load",checkUrlExists);